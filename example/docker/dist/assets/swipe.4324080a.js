import{Q as e,d as t,O as o,c as s,j as n,A as a,D as l,k as c,o as i,a as u,w as r,b as f,e as v,u as d,r as p,n as m,g as h}from"./index-7ef9e5b0.js";import{c as g,o as w,q as _,r as b,g as y,s as S,P as $}from"./icon.4e54a3b5.js";import{u as k}from"./useTouch.827cd713.js";import{_ as P}from"./_plugin-vue_export-helper.1b428a4d.js";function C(t,o){const{getSelectorNodeInfo:s}=function(t){let o=null;return t||(t=e()),t||console.warn("useSelectorQuery","useSelectorQuery必须在setup函数中使用"),o=uni.createSelectorQuery().in(t),{query:o,getSelectorNodeInfo:e=>new Promise(((t,s)=>{o?o.select(e).boundingClientRect((o=>{o?t(o):s(new Error(`未找到对应节点: ${e}`))})).exec():s(new Error("未找到对应的SelectorQuery实例"))})),getSelectorNodeInfos:e=>new Promise(((t,s)=>{o?o.selectAll(e).boundingClientRect((o=>{const n=o;n&&n.length>0?t(n):s(new Error(`未找到对应节点: ${e}`))})).exec():s(new Error("未找到对应的SelectorQuery实例"))}))}}(o);return s(`#${t}`)}const M={...g,name:String,touchMoveStopPropagation:Boolean,touchMovePreventDefault:Boolean,disabled:Boolean,closeOnClick:w(["left","content","right"])},j={open:e=>e instanceof Object,close:e=>e instanceof Object,[_]:e=>b(e)},x=`${$}-swipe`,Q=t({name:x,options:{virtualHost:!0,addGlobalClass:!0}}),T=P(t({...Q,props:M,emits:j,setup(t,{expose:g,emit:w}){const b=t,$=e(),P=o("swipeGroup",null),M=s((()=>y(b,x))),j=S(),Q=`${x}-left-${j}`,T=n(0),O=`${x}-right-${j}`,D=n(0);async function E(e){return(await C(e,$)).width||0}a((()=>null==P?void 0:P.name.value),(e=>{b.name!==e&&P&&P.lock.value&&H()}));const I=n(!1);let A="",B="";const N=l({offset:0,moving:!1}),q=s((()=>({transform:`translate3d(${N.offset}px, 0, 0)`})));function G(e=""){if(P&&P.update(b.name),I.value)return;e&&(N.offset="left"===e?-D.value:T.value),I.value=!0;const t=A||e;w("open",{name:b.name,direction:t,position:t})}function H(){I.value&&(N.offset=0,I.value=!1,w("close",{name:b.name,direction:A,position:A}))}function R(e){b.closeOnClick.includes(e)&&H(),w(_,e)}const z=k();function X(e){b.disabled||z.start(e)}async function F(e){b.disabled||(z.move(e),z.isHorizontal()&&(N.moving=!0,function(e){A=e>0?"right":"left";let t=e;switch(A){case"left":t=I.value&&B===A||Math.abs(e)>D.value?-D.value:e;break;case"right":t=I.value&&B===A||Math.abs(e)>T.value?T.value:e}N.offset=t}(z.deltaX.value),b.touchMovePreventDefault&&e.preventDefault(),b.touchMoveStopPropagation&&e.stopPropagation()))}function J(){if(N.moving)switch(N.moving=!1,B=A,A){case"left":Math.abs(N.offset)<=D.value/2?H():(N.offset=-D.value,G());break;case"right":Math.abs(N.offset)<=T.value/2?H():(N.offset=T.value,G())}}return c((()=>{setTimeout((()=>{!async function(){const[e,t]=await Promise.all([E(Q),E(O)]);T.value=e,D.value=t}()}),100)})),g({open:G,close:H}),(e,t)=>{const o=h;return i(),u(o,{class:m(d(M)),style:v(b.customStyle)},{default:r((()=>[f(o,{class:"nut-swipe__inner",style:v(d(q)),onTouchstart:X,onTouchmove:F,onTouchend:J,onTouchcancel:J},{default:r((()=>[f(o,{id:Q,class:"nut-swipe__left",onClick:t[0]||(t[0]=e=>R("left"))},{default:r((()=>[p(e.$slots,"left",{},void 0,!0)])),_:3}),f(o,{class:"nut-swipe__content",onClick:t[1]||(t[1]=e=>R("content"))},{default:r((()=>[p(e.$slots,"default",{},void 0,!0)])),_:3}),f(o,{id:O,class:"nut-swipe__right",onClick:t[2]||(t[2]=e=>R("right"))},{default:r((()=>[p(e.$slots,"right",{},void 0,!0)])),_:3})])),_:3},8,["style"])])),_:3},8,["class","style"])}}}),[["__scopeId","data-v-c3167fd6"]]);export{T as _};
