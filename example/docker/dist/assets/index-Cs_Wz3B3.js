import{av as ee,d as j,t as te,z as E,l as W,c as Y,r as f,aw as ne,f as K,s as $,ax as oe,W as P,h as Q,j as ie,k as m,A as q,ay as V,az as se,C as G,aA as J,aB as le,aC as ae,_ as ce,R as de,N as R,O as re,U as T,M as D,P as ue,Q as fe,a0 as xe}from"./index-CVtWMJkx.js";import{b as F}from"./route-block-B_A1xBdJ.js";import{L as he}from"./index-0tjujYex.js";const me=Symbol(),ve=()=>ee(me,null),[ge,S,_e]=Y("list"),Te={error:Boolean,offset:W(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:E("down"),loadingText:String,finishedText:String,immediateCheck:te};var be=j({name:ge,props:Te,emits:["load","update:error","update:loading"],setup(e,{emit:u,slots:i}){const o=f(e.loading),l=f(),v=f(),s=ve(),g=ne(l),c=K(()=>e.scroller||g.value),b=()=>{q(()=>{if(o.value||e.finished||e.disabled||e.error||(s==null?void 0:s.value)===!1)return;const{direction:a}=e,p=+e.offset,y=V(c);if(!y.height||se(l))return;let t=!1;const n=V(v);a==="up"?t=y.top-n.top<=p:t=n.bottom-y.bottom<=p,t&&(o.value=!0,u("update:loading",!0),u("load"))})},L=()=>{if(e.finished){const a=i.finished?i.finished():e.finishedText;if(a)return m("div",{class:S("finished-text")},[a])}},H=()=>{u("update:error",!1),b()},N=()=>{if(e.error){const a=i.error?i.error():e.errorText;if(a)return m("div",{role:"button",class:S("error-text"),tabindex:0,onClick:H},[a])}},C=()=>{if(o.value&&!e.finished&&!e.disabled)return m("div",{class:S("loading")},[i.loading?i.loading():m(he,{class:S("loading-icon")},{default:()=>[e.loadingText||_e("loading")]})])};return $(()=>[e.loading,e.finished,e.error],b),s&&$(s,a=>{a&&b()}),oe(()=>{o.value=e.loading}),P(()=>{e.immediateCheck&&b()}),Q({check:b}),ie("scroll",b,{target:c,passive:!0}),()=>{var a;const p=(a=i.default)==null?void 0:a.call(i),y=m("div",{ref:v,class:S("placeholder")},null);return m("div",{ref:l,role:"feed",class:S(),"aria-busy":o.value},[e.direction==="down"?p:y,C(),L(),N(),e.direction==="up"?p:y])}}});const ye=G(be),[pe,I]=Y("text-ellipsis"),we={rows:W(1),dots:E("..."),content:E(""),expandText:E(""),collapseText:E(""),position:E("end")};var ke=j({name:pe,props:we,emits:["clickAction"],setup(e,{emit:u,slots:i}){const o=f(e.content),l=f(!1),v=f(!1),s=f(),g=f();let c=!1;const b=K(()=>l.value?e.collapseText:e.expandText),L=t=>{if(!t)return 0;const n=t.match(/^\d*(\.\d*)?/);return n?Number(n[0]):0},H=()=>{if(!s.value||!s.value.isConnected)return;const t=window.getComputedStyle(s.value),n=document.createElement("div");return Array.prototype.slice.apply(t).forEach(w=>{n.style.setProperty(w,t.getPropertyValue(w))}),n.style.position="fixed",n.style.zIndex="-9999",n.style.top="-9999px",n.style.height="auto",n.style.minHeight="auto",n.style.maxHeight="auto",n.innerText=e.content,document.body.appendChild(n),n},N=(t,n)=>{var A,w;const{content:x,position:M,dots:B}=e,k=x.length,U=0+k>>1,O=i.action?(w=(A=g.value)==null?void 0:A.outerHTML)!=null?w:"":e.expandText,Z=()=>{const d=(r,_)=>{if(_-r<=1)return M==="end"?x.slice(0,r)+B:B+x.slice(_,k);const h=Math.round((r+_)/2);return M==="end"?t.innerText=x.slice(0,h)+B:t.innerText=B+x.slice(h,k),t.innerHTML+=O,t.offsetHeight>n?M==="end"?d(r,h):d(h,_):M==="end"?d(h,_):d(r,h)};return d(0,k)},z=(d,r)=>{if(d[1]-d[0]<=1&&r[1]-r[0]<=1)return x.slice(0,d[0])+B+x.slice(r[1],k);const _=Math.floor((d[0]+d[1])/2),h=Math.ceil((r[0]+r[1])/2);return t.innerText=e.content.slice(0,_)+e.dots+e.content.slice(h,k),t.innerHTML+=O,t.offsetHeight>=n?z([d[0],_],[h,r[1]]):z([_,d[1]],[r[0],h])};return e.position==="middle"?z([0,U],[U,k]):Z()},C=()=>{const t=H();if(!t){c=!0;return}const{paddingBottom:n,paddingTop:A,lineHeight:w}=t.style,x=Math.ceil((Number(e.rows)+.5)*L(w)+L(A)+L(n));x<t.offsetHeight?(v.value=!0,o.value=N(t,x)):(v.value=!1,o.value=e.content),document.body.removeChild(t)},a=(t=!l.value)=>{l.value=t},p=t=>{a(),u("clickAction",t)},y=()=>{const t=i.action?i.action({expanded:l.value}):b.value;return m("span",{ref:g,class:I("action"),onClick:p},[t])};return P(()=>{C(),i.action&&q(C)}),J(()=>{c&&(c=!1,C())}),$([le,()=>[e.content,e.rows,e.position]],C),Q({toggle:a}),()=>m("div",{ref:s,class:I()},[l.value?e.content:o.value,v.value?y():null])}});const Ce=G(ke),X=j({name:"ScrollCache",__name:"index",setup(e,{expose:u}){u();const i=f(!1),o=f(!1),l=f([]);function v(){setTimeout(()=>{for(let c=0;c<10;c++)l.value.push("".concat(l.value.length+1));i.value=!1,l.value.length>=40&&(o.value=!0)},1e3)}const s=f(0);J(()=>{window.scrollTo(0,s.value)}),ae(()=>{s.value=window.scrollY||document.documentElement.scrollTop||document.body.scrollTop});const g={loading:i,finished:o,list:l,onLoad:v,scrollTop:s};return Object.defineProperty(g,"__isScriptSetup",{enumerable:!1,value:!0}),g}}),Se={class:"space-y-10"},Ee={class:"shrink-0"},Le={class:"rounded-full bg-gray-500/20 flex h-48 w-48 items-center justify-center overflow-hidden"},Ae={class:"text-[16px] text-zinc-600 tabular-nums dark:text-zinc-400"},Be={class:"flex-1 min-w-0"},Me={class:"mb-2 flex flex-row gap-1 w-full justify-between"},He={class:"text-[16px] text-zinc-600 font-semibold tracking-tight w-1/2 dark:text-white"},Ne={class:"text-[14px] text-zinc-500"};function ze(e,u,i,o,l,v){const s=Ce,g=ye;return R(),de(g,{loading:o.loading,"onUpdate:loading":u[0]||(u[0]=c=>o.loading=c),finished:o.finished,"finished-text":e.$t("scrollCache.finished"),"loading-text":e.$t("scrollCache.loading"),onLoad:o.onLoad},{default:re(()=>[T("ul",Se,[(R(!0),D(ue,null,fe(o.list,c=>(R(),D("li",{key:c,class:"p-3 flex gap-12"},[T("div",Ee,[T("div",Le,[T("span",Ae,xe(c),1)])]),T("div",Be,[T("div",Me,[T("h3",He,[m(s,{content:"".concat(e.$t("scrollCache.sectionTitle"))},null,8,["content"])]),u[1]||(u[1]=T("time",{class:"text-[12px] text-zinc-400 tabular-nums"},"2025-05-16",-1))]),T("p",Ne,[m(s,{rows:2,content:e.$t("scrollCache.sectionText")},null,8,["content"])])])]))),128))])]),_:1},8,["loading","finished","finished-text","loading-text"])}typeof F=="function"&&F(X);const Ue=ce(X,[["render",ze],["__file","C:/Users/Administrator/Desktop/vue-crx/vue3-vant-mobile/src/pages/scroll-cache/index.vue"]]);export{Ue as default};
