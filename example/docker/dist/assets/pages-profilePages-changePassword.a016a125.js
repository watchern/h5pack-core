import{_ as e}from"./LayoutDefault.42450bc0.js";import{_ as o}from"./Black.5562f5e4.js";import{_ as a}from"./input.ea4d2faf.js";import{D as t,j as s,k as l,J as n,o as r,p as c,q as p,b as u,w as d,F as i,s as m,u as h,f as _,t as f,l as x,m as w}from"./index-7ef9e5b0.js";import{_ as b}from"./button.c8a4a8e4.js";import{f as g,t as F}from"./index.5059ae5b.js";import{g as v}from"./index.ca928f2d.js";import{r as E}from"./router.34791702.js";import{u as j}from"./pinia-auto-refs.64a97d29.js";import{_ as y}from"./_plugin-vue_export-helper.1b428a4d.js";import"./icon.4e54a3b5.js";import"./request.55a7bd8a.js";import"./urlMap.3d32d270.js";const W=y({__name:"changePassword",setup(y){const{userInfo:W}=j("root");v();const V=t({account:"",passWord:"",passWord2:"",code:"",countdown:0,checkbox:!0,timer:null,type:!0}),k=s(!1);function T(){console.log("state.account",V.account),""!==V.account&&11===V.account.length?V.countdown>0||(g({phoneNumber:V.account}).then((e=>{uni.showToast({title:"验证码已发送",icon:"success",duration:800})})).catch((e=>{console.log("err====",e)})),V.countdown=60,V.timer=setInterval((()=>{V.countdown-=1,V.countdown<=0&&clearInterval(V.timer)}),1e3)):uni.showToast({title:"请填写完整的手机号码",icon:"none"})}async function N(){k.value||(k.value=!0,!function(){let e="";""!==V.account&&11===V.account.length||(e+="请填写完整的手机号码");""===V.code&&(e+=""!==e?",验证码不能为空":"验证码不能为空");""===V.passWord&&(e+=""!==e?",密码不能为空":"密码不能为空");/[A-Z]/.test(V.passWord)||(e+=""!==e?",密码缺少大写字母":"密码缺少大写字母");/[a-z]/.test(V.passWord)||(e+=""!==e?",密码缺少小写字母":"密码缺少小写字母");/[0-9]/.test(V.passWord)||(e+=""!==e?",密码缺少数字":"密码缺少数字");""===V.passWord2&&(e+=""!==e?",确认密码不能为空":"确认密码不能为空");V.passWord!==V.passWord2&&(e+=""!==e?",两次密码不同,请重新输入":"两次密码不同,请重新输入");return""===e||(console.log(`${""!==e?`${e}`:e}`),uni.showToast({title:`${""!==e?`${e}`:e}`,icon:"none"}),!1)}()?setTimeout((()=>{uni.hideToast(),k.value=!1}),1e3):F({phoneNumber:V.account,code:V.code,pws:V.passWord}).then((()=>{uni.showToast({title:"修改成功",icon:"none"}),E()})).catch((e=>{console.log("err====",e),k.value=!1})))}return l((()=>{uni.hideTabBar({success:()=>{},fail:()=>{}})})),n((()=>{V.account=W.value.phonenumber})),(t,s)=>{const l=o,n=x(w("nut-input"),a),g=x(w("nut-button"),b),F=e;return r(),c(i,null,[p(" _wn_left color-_wn_262727 bg-_wn_EFEFEF h-100vh h-10px clearable readonly _wn_right text-12px text-_wn_666 pl-10px mt-10px pt-40px px-20px "),u(F,{title:"修改密码",full:!0,background:"#fefefe"},{left:d((()=>[u(l,{color:"#262727",class:"color-_wn_262727"})])),default:d((()=>[m("div",{bg:"#EFEFEF",h:"100vh",class:"bg-_wn_EFEFEF h-100vh"},[m("div",{"h-10px":"",bg:"#EFEFEF",class:"h-10px bg-_wn_EFEFEF"}),u(n,{modelValue:h(W).nickName,"onUpdate:modelValue":s[0]||(s[0]=e=>h(W).nickName=e),placeholder:"请输入手机号码","max-length":"11",clearable:"",readonly:"",class:"clearable readonly"},{left:d((()=>[_(" 用户姓名： ")])),_:1},8,["modelValue"]),u(n,{modelValue:h(V).code,"onUpdate:modelValue":s[1]||(s[1]=e=>h(V).code=e),placeholder:"请输入验证码",clearable:"",class:"clearable"},{left:d((()=>[_(" 验证码： ")])),right:d((()=>[u(g,{type:"primary",size:"small",onClick:T},{default:d((()=>[_(f(h(V).countdown>0?`${h(V).countdown}秒`:"获取验证码"),1)])),_:1})])),_:1},8,["modelValue"]),u(n,{modelValue:h(V).passWord,"onUpdate:modelValue":s[2]||(s[2]=e=>h(V).passWord=e),placeholder:"设置新密码",type:"password",clearable:"",class:"clearable"},{left:d((()=>[_(" 新密码： ")])),right:d((()=>[])),_:1},8,["modelValue"]),u(n,{modelValue:h(V).passWord2,"onUpdate:modelValue":s[3]||(s[3]=e=>h(V).passWord2=e),placeholder:"确认新密码",type:"password",clearable:"",class:"clearable"},{left:d((()=>[_(" 确认密码： ")])),right:d((()=>[])),_:1},8,["modelValue"]),m("div",{text:"12px #666","pl-10px":"","mt-10px":"",class:"text-12px text-_wn_666 pl-10px mt-10px"}," 密码需包含字母及数字组合（不能是纯数字） "),m("div",{"pt-40px":"","px-20px":"",class:"pt-40px px-20px"},[u(g,{loading:h(k),style:{width:"100%"},type:"primary",onClick:N},{default:d((()=>[_(" 提交修改 ")])),_:1},8,["loading"])])])])),_:1})],2112)}}},[["__scopeId","data-v-a54412e2"]]);export{W as default};
