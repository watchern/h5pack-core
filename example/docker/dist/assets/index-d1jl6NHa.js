import{aC as ee,d as F,t as te,z as H,l as W,c as G,r as d,aD as ne,f as K,s as j,aE as oe,Y as Q,h as q,j as ie,k as v,v as J,aF as V,aG as se,C as P,aH as X,aI as le,ak as ae,T as ce,N as $,O as de,W as b,M as Y,R as re,S as ue,Q as z,a1 as fe,P as xe}from"./index-B-i8mpT1.js";import{L as he}from"./index-BjjgmjDd.js";import{b as D}from"./route-block-B_A1xBdJ.js";const me=Symbol(),ve=()=>ee(me,null),[ge,S,Te]=G("list"),_e={error:Boolean,offset:W(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:H("down"),loadingText:String,finishedText:String,immediateCheck:te};var ye=F({name:ge,props:_e,emits:["load","update:error","update:loading"],setup(e,{emit:u,slots:i}){const l=d(e.loading),r=d(),g=d(),o=ve(),T=ne(r),_=K(()=>e.scroller||T.value),f=()=>{J(()=>{if(l.value||e.finished||e.disabled||e.error||(o==null?void 0:o.value)===!1)return;const{direction:s}=e,k=+e.offset,w=V(_);if(!w.height||se(r))return;let t=!1;const n=V(g);s==="up"?t=w.top-n.top<=k:t=n.bottom-w.bottom<=k,t&&(l.value=!0,u("update:loading",!0),u("load"))})},x=()=>{if(e.finished){const s=i.finished?i.finished():e.finishedText;if(s)return v("div",{class:S("finished-text")},[s])}},N=()=>{u("update:error",!1),f()},A=()=>{if(e.error){const s=i.error?i.error():e.errorText;if(s)return v("div",{role:"button",class:S("error-text"),tabindex:0,onClick:N},[s])}},E=()=>{if(l.value&&!e.finished&&!e.disabled)return v("div",{class:S("loading")},[i.loading?i.loading():v(he,{class:S("loading-icon")},{default:()=>[e.loadingText||Te("loading")]})])};return j(()=>[e.loading,e.finished,e.error],f),o&&j(o,s=>{s&&f()}),oe(()=>{l.value=e.loading}),Q(()=>{e.immediateCheck&&f()}),q({check:f}),ie("scroll",f,{target:_,passive:!0}),()=>{var s;const k=(s=i.default)==null?void 0:s.call(i),w=v("div",{ref:g,class:S("placeholder")},null);return v("div",{ref:r,role:"feed",class:S(),"aria-busy":l.value},[e.direction==="down"?k:w,E(),x(),A(),e.direction==="up"?k:w])}}});const be=P(ye),[we,O]=G("text-ellipsis"),ke={rows:W(1),dots:H("..."),content:H(""),expandText:H(""),collapseText:H(""),position:H("end")};var pe=F({name:we,props:ke,emits:["clickAction"],setup(e,{emit:u,slots:i}){const l=d(e.content),r=d(!1),g=d(!1),o=d(),T=d();let _=!1;const f=K(()=>r.value?e.collapseText:e.expandText),x=t=>{if(!t)return 0;const n=t.match(/^\d*(\.\d*)?/);return n?Number(n[0]):0},N=()=>{if(!o.value||!o.value.isConnected)return;const t=window.getComputedStyle(o.value),n=document.createElement("div");return Array.prototype.slice.apply(t).forEach(p=>{n.style.setProperty(p,t.getPropertyValue(p))}),n.style.position="fixed",n.style.zIndex="-9999",n.style.top="-9999px",n.style.height="auto",n.style.minHeight="auto",n.style.maxHeight="auto",n.innerText=e.content,document.body.appendChild(n),n},A=(t,n)=>{var L,p;const{content:h,position:B,dots:M}=e,C=h.length,I=0+C>>1,U=i.action?(p=(L=T.value)==null?void 0:L.outerHTML)!=null?p:"":e.expandText,Z=()=>{const a=(c,y)=>{if(y-c<=1)return B==="end"?h.slice(0,c)+M:M+h.slice(y,C);const m=Math.round((c+y)/2);return B==="end"?t.innerText=h.slice(0,m)+M:t.innerText=M+h.slice(m,C),t.innerHTML+=U,t.offsetHeight>n?B==="end"?a(c,m):a(m,y):B==="end"?a(m,y):a(c,m)};return a(0,C)},R=(a,c)=>{if(a[1]-a[0]<=1&&c[1]-c[0]<=1)return h.slice(0,a[0])+M+h.slice(c[1],C);const y=Math.floor((a[0]+a[1])/2),m=Math.ceil((c[0]+c[1])/2);return t.innerText=e.content.slice(0,y)+e.dots+e.content.slice(m,C),t.innerHTML+=U,t.offsetHeight>=n?R([a[0],y],[m,c[1]]):R([y,a[1]],[c[0],m])};return e.position==="middle"?R([0,I],[I,C]):Z()},E=()=>{const t=N();if(!t){_=!0;return}const{paddingBottom:n,paddingTop:L,lineHeight:p}=t.style,h=Math.ceil((Number(e.rows)+.5)*x(p)+x(L)+x(n));h<t.offsetHeight?(g.value=!0,l.value=A(t,h)):(g.value=!1,l.value=e.content),document.body.removeChild(t)},s=(t=!r.value)=>{r.value=t},k=t=>{s(),u("clickAction",t)},w=()=>{const t=i.action?i.action({expanded:r.value}):f.value;return v("span",{ref:T,class:O("action"),onClick:k},[t])};return Q(()=>{E(),i.action&&J(E)}),X(()=>{_&&(_=!1,E())}),j([le,()=>[e.content,e.rows,e.position]],E),q({toggle:s}),()=>v("div",{ref:o,class:O()},[r.value?e.content:l.value,g.value?w():null])}});const Ce=P(pe),Ee={class:"space-y-10"},Se={class:"shrink-0"},He={class:"rounded-full bg-gray-500/20 flex h-48 w-48 items-center justify-center overflow-hidden"},Le={class:"text-[16px] text-zinc-600 tabular-nums dark:text-zinc-400"},Me={class:"flex-1 min-w-0"},Be={class:"mb-2 flex flex-row gap-1 w-full justify-between"},Ne={class:"text-[16px] text-zinc-600 font-semibold tracking-tight w-1/2 dark:text-white"},Ae={class:"text-[14px] text-zinc-500"},Re=F({name:"ScrollCache",__name:"index",setup(e){const u=d(!1),i=d(!1),l=d([]);function r(){setTimeout(()=>{for(let o=0;o<10;o++)l.value.push("".concat(l.value.length+1));u.value=!1,l.value.length>=40&&(i.value=!0)},1e3)}const g=d(0);return X(()=>{window.scrollTo(0,g.value)}),ae(()=>{g.value=window.scrollY||document.documentElement.scrollTop||document.body.scrollTop}),(o,T)=>{const _=Ce,f=be;return $(),ce(f,{loading:z(u),"onUpdate:loading":T[0]||(T[0]=x=>xe(u)?u.value=x:null),finished:z(i),"finished-text":o.$t("scrollCache.finished"),"loading-text":o.$t("scrollCache.loading"),onLoad:r},{default:de(()=>[b("ul",Ee,[($(!0),Y(re,null,ue(z(l),x=>($(),Y("li",{key:x,class:"p-3 flex gap-12"},[b("div",Se,[b("div",He,[b("span",Le,fe(x),1)])]),b("div",Me,[b("div",Be,[b("h3",Ne,[v(_,{content:"".concat(o.$t("scrollCache.sectionTitle"))},null,8,["content"])]),T[1]||(T[1]=b("time",{class:"text-[12px] text-zinc-400 tabular-nums"},"2025-05-16",-1))]),b("p",Ae,[v(_,{rows:2,content:o.$t("scrollCache.sectionText")},null,8,["content"])])])]))),128))])]),_:1},8,["loading","finished","finished-text","loading-text"])}}});typeof D=="function"&&D(Re);export{Re as default};
